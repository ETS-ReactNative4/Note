[用JavaScript写一个区块链](https://zhuanlan.zhihu.com/p/34522746)

>  区块链就是通过密码学的方式形成的一个由集体维护的分布式数据库。
在解释区块链具体是什么东西之前我认为最核心的是要知道“我们为什么要用区块链技术”。

## 区块链的几个特性：
1. 去中心化，没有第三方中介，一切都由程序来完成。
2. 安全性，主要体现在分布式，51％攻击，即使一个节点被攻击或宕机也不会影响网络的运行。
3. 最核心的就是：去信任一切社会行为都要建立在”信任“的基础上，这也是区块链解决的最根本的问题。

## 加密货币（Cryptocurrency
我们常说的比特币，是加密货币（Cryptocurrency）的一种，而加密货币实现去中心化的最关键的技术是区块链
加密货币一定具有下列三个特点:
* 去中心的清算
* 分布式的记账
* 离散化的支付
为了实现这些特点，需要使用到区块链技术。这里的区块链技术是一个很广义的范畴，它包含了密码学，算法等很多不同的内容，其中最精彩的点子，可算是 工作量证明 = 共识

### bitcoin
那么当你按下“转账”按钮时，背后的区块链系统到底发生了什么？
1. 使用私钥对这笔即将发生的交易进行签名
2. 从你的客户端把你的这笔交易提交到区块链网络
3. 由已经开启“挖矿”程序的计算机（称为矿机）把10分钟内的交易打包成一个数据块（相当于一个账本，其中就包含了小明的这笔交易）
4. 而此时，这些区块主体中的交易并未生效。
5. 那么如何使这些交易生效呢？每个区块中都有一个哈希值，通过不断哈希运算，不断哈希运算（可能是几亿次）最终找到一个比当前哈希小的值，就认为这个区块被确认。即为交易生效，这个过程就称为“挖矿”
6. 那谁来做这个哈希呢？全球那么多交易，如果只是一家公司的几台计算机是远远不够的。所以，比特币有“激励机制”，当一台计算机确认了一个区块，就可以奖励12.5个比特币。

## 第一个用户需求 - 账本和电子签名的由来
> 摆脱现金进行交易带来的不便-【解决办法】几个用户使用公共账本记录转账记录，月底结算，账本公开，每个人都可以修改，也就是说可以在上面添加新行（一笔交易）

一个大家都遵守的协议:
* 任何人都可以在账本上添加新行
* 固定时间间隔时用真金白银进行清算
* 只有有签名的交易是有效的
* 中间担保的人保证不可超支

利用这个提出需求再解决问题的过程，强化一个认知：货币 = 交易记录（账本），即货币的本质是交易记录，在这背后，有一个前提是，货币的另一个本质是一种共识，我们都信任它有价值的共识

### 如何实现分布记账（去中心化）
每个用户保存账本，分布记账。用户产生一笔交易就将这笔交易广播到到网络上所有的节点上，这样不就完美的去中心化了？
如何让所有人都同意这个新账本？如何保持这些账本同步？有一笔交易发生时，如何让其他人都听到并相信这一笔交易呢？

解决的思路是：哪个账本的计算工作量大，就信任哪个账本。换个角度来说是【让交易欺诈和账本不一的情形的计算力成本高到不能接受甚至完全不可行】

1. 密码学：哈希函数
哈希函数，输入可以是任意信息或者文件，输出是固定长度的比特串。例如256bit的1/0串，这个输出叫做这个信息的“哈希值”或者“摘要”（digest）。SHA256就是一个哈希函数

2. 区块链 - 信任与共识的基石




