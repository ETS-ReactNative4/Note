>Nginx("engine x")是一款是由俄罗斯的程序设计师Igor Sysoev所开发高性能的 Web和 反向代理 服务器，也是一个 IMAP/POP3/SMTP 代理服务器。可以在UNIX、GNU/Linux、BSD、Mac OS X、Solaris，以及Microsoft Windows等操作系统中运行。
在高连接并发的情况下，Nginx是Apache服务器不错的替代品。
Nginx是一款轻量级的网页服务器、反向代理器以及电子邮件代理服务器。其将源代码以类BSD许可证的形式发布，因它的稳定性、丰富的功能集、示例配置文件和低系统资源的消耗而闻名。
说到Web服务器，Apache服务器和IIS服务器是两大巨头；但是运行速度更快、更灵活的对手：Nginx 正在迎头赶上。

## nginx的作用
* 保护网站安全：任何来自Internet的请求都必须先经过代理服务器；
* 通过配置缓存功能加速Web请求：可以缓存真实Web服务器上的某些静态资源，减轻真实Web服务器的负载压力；
* 实现负载均衡：充当负载均衡服务器均衡地分发请求，平衡集群中各个服务器的负载压力；


## nginx的安装
### 一、安装编译工具及库文件
	yum -y install make zlib zlib-devel gcc-c++ libtool  openssl openssl-devel

### 二、首先要安装 PCRE
PCRE 作用是让 Nginx 支持 Rewrite 功能。
1、下载 PCRE 安装包，下载地址： http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz
	[root@bogon src]# wget http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz

2、解压安装包:
[root@bogon src]# tar zxvf pcre-8.35.tar.gz

3、进入安装包目录
[root@bogon src]# cd pcre-8.35

4、编译安装 
[root@bogon pcre-8.35]# ./configure
[root@bogon pcre-8.35]# make && make install

5、查看pcre版本
[root@bogon pcre-8.35]# pcre-config --version

[CentOS 6.5安装Nginx-1.6.2及安全配置](https://www.linuxidc.com/Linux/2016-12/137984.htm)
### 三、安装 Nginx  
0、环境准备 yum -y install gcc gcc-c++ autoconf automake make
1、下载 Nginx，下载地址：http://nginx.org/download/nginx-1.6.2.tar.gz
cd /usr/local/src
[root@bogon src]# wget http://nginx.org/download/nginx-1.6.2.tar.gz

2、解压安装包
[root@bogon src]# tar zxvf nginx-1.6.2.tar.gz

3、进入安装包目录
[root@bogon src]# cd nginx-1.6.2

4、编译安装
```
然后创建www的用户组和用户，并且不允许登录权限：

# id www
id: www：无此用户
# groupadd www
# useradd -g www -s /sbin/nologin www
# id www
uid=501(www) gid=501(www) 组=501(www) 
```

./configure --prefix=/usr/local/nginx-1.6.2 --group=www --user=www --with-http_ssl_module --with-pcre --with-http_stub_status_module --with-http_gzip_static_module

执行完成，做编译安装操作
make && make install
然后
# ln -s /usr/local/nginx-1.6.2/ /usr/local/nginx
# chown -R www:www /usr/local/nginx
# chown -R www:www /usr/local/nginx-1.6.2


5、查看nginx版本
[root@cache nginx]# /usr/local/nginx/sbin/nginx -v
nginx version: nginx/1.6.2

到此，nginx安装完成。

### 第4步编译报错
./configure: error: SSL modules require the OpenSSL library.

解决方法：
yum -y install openssl openssl-devel  

安装完毕再执行4

解决下面错误
./configure: error: the HTTP rewrite module requires the PCRE library.
You can either disable the module by using --without-http_rewrite_module
option, or install the PCRE library into the system, or build the PCRE library
statically from the source with nginx by using --with-pcre=<path> option.

安装pcre-devel解决问题
yum -y install pcre-devel

### Ubuntu 安装
http://blog.csdn.net/wm_1991/article/details/50493487


[nginx 基本入门](https://zhuanlan.zhihu.com/p/24382606)
> nginx 有一个主进程和其他子进程。主进程的主要工作是加载和执行配置文件，并且驻留子进程。子进程用来作为实际的请求处理。nginx 采取基于事件的模型和 OS 依赖的机制，在多个子进程之间高效的分配请求。子进程的个数会直接写在配置文件中并且，对于给定的配置可以是固定的，或者根据可用的 CPU 核数自动的进行调整（参考 子进程）。 nginx 和它模块的工作方式是在配置文件中写好的。默认情况下，这个配置文件通常命名为 nginx.conf 并且会放置在 /usr/local/nginx/conf，/etc/nginx，或者 /usr/local/etc/nginx。

## 配置
### 修改配置文件
cd /usr/local/nginx/conf
[root@cache conf]# vim nginx.conf
### 启用，停止，重载
cd /usr/local/nginx/sbin
[root@cache sbin]# ./nginx -s reload

nginx -s signal

signal 可以为下列命令之一：

stop — 直接关闭 nginx
quit — 会在处理完当前正在的请求后退出，也叫优雅关闭
reload — 重新加载配置文件，相当于重启
reopen — 重新打开日志文件 比如，等待当前子进程处理完正在执行的请求后，结束 nginx 进程，可以使用下列命令：

为了得到所有正在运行的 nginx 进程，我们可能会使用到 ps 工具，比如，像下列的方式：
$ ps -ax | grep nginx
	// 结果为：（下面是单核 CPU 的情况）
	 516 pts/0    D+     0:00 grep --color=auto nginx
	 1156 ?        S      1:22 nginx: worker process
	27999 ?        Ss     0:00 nginx: master process ./nginx

mxj@ubuntu:~$ ps -ax | grep nginx
	 4560 ?        Ss     0:00 nginx: master process nginx -c /usr/local/nginx/conf/nginx.conf
	 4561 ?        S      0:00 nginx: worker process                    
	 4572 pts/0    S+     0:00 grep --color=auto nginx

### 配置文件结构
nginx 是由一些模块组成，我们一般在配置文件中使用一些具体的指令来控制它们。指令被分为简单指令和块级命令。一个简单的指令是由名字和参数组成，中间用空格分开，并以分号结尾。例如：
	// 简单指令
	root /data/www;

	// 块指令
	# this is a comment
	events {
	  worker_connections  4096;  ## Default: 1024
	}

	http {
	    server { 
	         listen       80;
	         server_name  domain1.com www.domain1.com;
	         access_log   logs/domain1.access.log  main;
	         root         html;

	         location ~ \.php$ {
	           fastcgi_pass   127.0.0.1:1025;
	         }
	    }
	}

#### 官网配置
[How nginx processes a request](http://nginx.org/en/docs/http/request_processing.html)


### 搭建一个简易的代理服务
nginx 常常用来作为代理服务器，这代表着服务器接收请求，然后将它们传递给被代理服务器，得到请求的响应，再将它们发送给客户端。 我们将配置一个基本的代理服务器，它会处理本地图片文件的请求并返回其他的请求给被代理的服务器。在这个例子中，两个服务器都会定义在一个 nginx 实例中。 首先，通过在 nginx 配置文件中添加另一个 server区块，来定义一个被代理的服务器，像下面的配置：

使用前面章节中的 server 配置，然后将它改为一个代理服务配置。在第一个 location 区块中，放置已经添加被代理服务器的协议，名字和端口等参数的 proxy_pass 指令（在这里，就是 http://localhost:8080）

	server {
	    location / {
	        proxy_pass http://localhost:8080;
	    }

	    location ~ \.(gif|jpg|png)$ {
    		root /data/images;
		}
	}
该参数是一个正则表达式，它会匹配所有以 .gif，.jpg 或者 .png 结尾的 URIs。一个正则表达式需要以 ~ 开头。




