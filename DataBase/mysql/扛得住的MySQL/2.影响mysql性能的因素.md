## 服务器硬件

硬盘：固态硬盘比机械磁盘有更好的随机读写性能，能支持更好的并发
缺点是每次读写都需要对存储单元进行擦除，密集的读写操作压力下比较容易损坏

可以直接把SSD接到SATA接口上
串行ATA（Serial ATA: Serial Advanced Technology Attachment）是一种计算机总线，负责主板和大容量存储设备（如硬盘及光盘驱动器）之间的数据传输，主要用于个人计算机。

CPU：
* 并发比较高的场景CPU的数量（核数）比频率重要
* 对于CPU密集型的、复杂的SQL则频率越高越好

内存：（足够的内存可以减少随机IO的发生，但是不能避免）
* 选择主板所能使用的最高频率的内存
* 内存的大小对性能很重要，所以竟可能的大

I/O子系统（硬盘）
PCIe -> SSD -> Raid10 -> 磁盘 -> SAN
 

## 服务器系统

CentOS系统参数的优化

内核相关参数（/etc/sysctl.conf）

kenel.shmmax = 4222342432


## 数据库存储引擎的选择

MyISAM: 不支持事务，表级锁。 5.5之前版本的默认存储引擎

```
create table myIsam(id int,c1 varchar(10))engine=myisam;
```

InnoDB: 事务级存储引擎，完美支持行级锁，事务ACID特性。


## 数据库参数配置

I/O相关参数配置

Innodb_log_file_size  事务日志大小


## 数据库结构设计和SQL语句（首要考虑的优化选项）

* 过分的反范式化为表建立太多的列
* 过分的表关联

## 数据库优化顺序
1. 数据库结构设计和SQL语句
2. 数据库存储引擎的选择和参数配置
3. 系统选择及优化
4. 硬件升级


## Mysql基准测试
1. 建立MySQL服务器的性能基准线
2. 模拟比当前系统更高的负载，找出系统的扩展瓶颈，增加数据库并发，观察QPS，TPS变化确定并发量与性能最优的关系
3. 测试不同硬件、软件和操作系统配置
4. 证明新的硬件设备是否配置正确

### 如何基准测试 
1. 对系统整体测试
2. 单独对MySQL测试
   
基准测试常见指标
1. 单位时间内所处理的事务数（TPS）
2. 单位时间内锁处理的查询数（QPS）
3. 响应时间
4. 并发量：同时处理的查询请求的数量（而不是连接数）

### 测试工具
sysbench

## MySql数据库结构优化
* 减少数据冗余
* 尽量避免数据维护中出现更新，插入和删除异常（插入异常：表中的一个实体依赖另一个实体而存在）

### [数据库设计范式](../../mysql/范式与反范式.md)

进度4-3