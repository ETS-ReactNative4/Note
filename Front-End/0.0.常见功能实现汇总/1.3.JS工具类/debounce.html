<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>返回顶部</title>
    <style>
        body {
            height: 5000px; 
        }
        .top {
            position: fixed;
            right: 10px;
            bottom: 30px;
        }
        .hide {
            display: none;
        }
    </style>
</head>
<script src="./DT.js"></script>
<body>
    <button class="top hide" id="top" onclick="returnTop()">返回顶部</button>
    <input type="text" id="name">
    <button id="submit">提交信息</button>
    <button>获取信息</button>
    <script>
        // 发送验证码场景 防抖
        function sendCode() {
            // console.log('sendCode-get-click-arguments:', arguments)
            console.log('验证码已发送...for:', arguments)
        }

        let userInfo = {name: 'jack', password: '123', i: 0}
        // document.querySelector('#submit').addEventListener('click', function() {
        //     userInfo.i += 1
        //     debounce(sendCode, 5000)
        // })

        const btn = document.getElementById('submit')
        // btn.onclick = debounce(sendCode, 2000)
        // btn.addEventListener('click', debounce(sendCode, 2000))
        // 下面的方式不行，类似的聊天室事件也不行
        // btn.addEventListener('click', function() {
        //     debounce(sendCode, 2000)
        // })

        // 事件的注册与监听


        // 展示button 打印滚动条位置
        function showTop  () {
            var scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
        　　 console.log('滚动条位置：' + scrollTop);
            if (scrollTop > 1000) {
                document.getElementById('top').classList.remove('hide')
            } else {
                document.getElementById('top').classList.add('hide')
            }
        }

        // 点击按钮返回顶鼓
        function returnTop () {
            document.body.scrollTop = document.documentElement.scrollTop = 0
        }

        // 高频事件触发
        // window.onscroll = debounce(showTop, 400)

        window.onload = function () {
            //模拟ajax请求
            function ajax(content) {
                console.log('ajax request ' + content)
            }
            let inputNormal = document.getElementById('name');
            // 每次按键抬起都会触发，期望输入完成再触发 延时触发
            // inputNormal.addEventListener(' keyup', function (e) {
            //     ajax(e.target.value)
            // })
            // let debounceAjax = debounce(ajax, 400)
            inputNormal.addEventListener('keyup', function (e) {
                debounceAjax(e.target.value)
            })
        }

        // 节流函数
        function throttle (fn, delay) {
            let valid = true
            let timer = null
            return function(args) {
                if(!valid) return
                valid = false
                timer = setTimeout(() => {
                   fn.call(this, args) 
                   valid = true
                   console.log('timer:', timer)
                   clearTimeout(timer)
                }, delay)
            }
        }

        function sayHi(e) {
            console.log('节流：', e.target.innerWidth, e.target.innerHeight);
        }
        window.addEventListener('resize', throttle(sayHi,1500));
    </script>
</body>
</html>