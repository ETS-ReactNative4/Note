<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Document</title>
    <!-- 没有任何效果 -->
    <!-- <link rel="import" href="http://stackoverflow.com"> -->
    <style>
        #child {
            color: blueviolet;
        }
    </style>
</head>
<body>
    <div id="child">parent</div>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>

    <iframe id="i1" src="./child.html" frameborder="0" width="100%" height="400"></iframe>
    <!-- <iframe id="i2" src="https://h5meet.polyv.net/login?channelId=2822552" frameborder="0" width="100%" height="800" ></iframe> -->
    
    <button data-theme="light">Light Theme</button>
    <button data-theme="dark">Dark Theme</button>
    <iframe id="i3" src="./cross.html" onload="load()"></iframe>
    
    <div id="target"></div>

    <script>
        
        $('#i1').load(function () {

            var cssLink = document.createElement("link");

            cssLink.href = "style.css";

            cssLink.rel = "stylesheet";

            cssLink.type = "text/css";

            // console.log(frames.document.head)
            // frames.document.head.appendChild(cssLink);
            // $('#i1')
            //         .contents().find("body")
            //         .html("test iframe");
            $('#i1')
                .contents().find("head")
                .append($('<link rel="stylesheet" type="text/css" href="style.css">')
            );
            
        });


        $('#i2').load(function () {
            var cssLink = document.createElement("link");

            cssLink.href = "style.css";

            cssLink.rel = "stylesheet";

            cssLink.type = "text/css";

            // $('#i2')
            //     .contents().find("head")
            //     .append($('<link rel="stylesheet" type="text/css" href="style.css">')
            // );
        })

        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/contentDocument
        function load() {
            console.log('loaded')
            // If the iframe and the iframe's parent document are Same Origin, returns a Document 
            // (that is, the active document in the inline frame's nested browsing context), else returns null.
            // console.log(document.getElementsByTagName("iframe")[1].contentDocument)
    
            // console.log(document.getElementsByTagName("iframe")[1].contentWindow.postMessage)
            activateTheme("light");

        }

        function activateTheme(theme) {
            var iframe = document.getElementById("i3");
            if (iframe && iframe.contentWindow) {
                iframe.contentWindow.postMessage(theme, "*");
            }
        }

        $("button[data-theme]").on("click", function (event) {
            activateTheme($(this).data("theme"));
        });

        // 同样会跨域
        // $('#target').load('https://h5meet.polyv.net/login?channelId=2822552', function() {
        //     console.log('Load was performed.')
        // })
        $.ajax({
            url: 'https://h5meet.polyv.net/login?channelId=2822552',
            xhrFields: {
                withCredentials: true
            }
        })
    </script>
</body>
</html>

<!-- 参考链接 
Cross-document communication with iframes 
https://benohead.com/blog/2015/12/07/cross-document-communication-with-iframes/


JSONP
https://www.w3schools.com/js/js_json_jsonp.asp
Understanding Cross-Domain Javascript – JSONP and IFrames
https://snaggled.github.io/2010/04/08/Understanding-cross-domain-javascript.html
-->